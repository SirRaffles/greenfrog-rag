# ============================================
# RAG V2 Configuration (New Features)
# ============================================

# Enable RAG V2 endpoints (true/false)
# When enabled, creates /api/v2/chat endpoints with:
# - Semantic caching (Redis + embeddings)
# - Hybrid retrieval (BM25 + semantic)
# - Optional reranking
# - SSE streaming
USE_RAG_V2=true

# Enable semantic caching (true/false)
# Uses Redis + sentence embeddings for similarity-based cache lookup
USE_CACHE=true

# Enable document reranking (true/false)
# Reranks retrieved documents by relevance before context building
USE_RERANK=true

# ============================================
# Redis Cache Configuration
# ============================================

# Redis connection URL
REDIS_URL=redis://greenfrog-redis:6379

# Cache TTL (seconds) - how long to keep cached responses
CACHE_TTL_SECONDS=3600

# Semantic similarity threshold (0.0-1.0)
# Higher = stricter matching
# 0.85 = balanced (recommended for production)
# 0.90 = strict
# 0.80 = lenient
CACHE_SIMILARITY_THRESHOLD=0.85

# Embedding model for cache similarity
# Options: all-MiniLM-L6-v2 (fast), all-mpnet-base-v2 (accurate)
CACHE_EMBEDDING_MODEL=all-MiniLM-L6-v2

# ============================================
# Ollama Configuration
# ============================================

# Ollama API base URL
OLLAMA_BASE_URL=http://ollama:11434

# Default LLM model for RAG V2
OLLAMA_MODEL=phi3:mini

# Ollama request timeout (seconds)
OLLAMA_TIMEOUT=120

# ============================================
# Qdrant Vector Database Configuration
# ============================================

# Qdrant API URL
QDRANT_URL=http://qdrant:6333

# Default collection name
QDRANT_COLLECTION=greenfrog

# Embedding model for document retrieval
# Must match the model used during indexing
EMBEDDING_MODEL=nomic-embed-text:latest

# ============================================
# Retrieval Configuration
# ============================================

# Hybrid search weights
# BM25 weight (0.0-1.0)
BM25_WEIGHT=0.5

# Semantic search weight (0.0-1.0)
SEMANTIC_WEIGHT=0.5

# Minimum retrieval score (0.0-1.0)
MIN_RETRIEVAL_SCORE=0.0

# ============================================
# Example Usage
# ============================================

# Full RAG V2 configuration (production):
# USE_RAG_V2=true
# USE_CACHE=true
# USE_RERANK=true
# REDIS_URL=redis://greenfrog-redis:6379
# OLLAMA_BASE_URL=http://ollama:11434
# QDRANT_URL=http://qdrant:6333
# OLLAMA_MODEL=phi3:mini

# Minimal configuration (development):
# USE_RAG_V2=true
# USE_CACHE=false
# USE_RERANK=false

# ============================================
# API Endpoints (when USE_RAG_V2=true)
# ============================================

# POST /api/v2/chat/query
#   - Non-streaming RAG query
#   - Returns JSON with response, sources, metadata

# POST /api/v2/chat/stream
#   - Streaming RAG query (SSE)
#   - Returns Server-Sent Events

# GET /api/v2/chat/health
#   - Health check for all V2 services
#   - Returns cache, ollama, retrieval, rerank status

# GET /api/v2/chat/stats
#   - Aggregate statistics
#   - Cache hit rate, document count, etc.

# POST /api/v2/chat/cache/invalidate
#   - Clear cache entries
#   - Admin endpoint
